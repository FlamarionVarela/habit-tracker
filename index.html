<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rastreador de Hábitos Circular</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React 18 -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
        }
        
        .typewriter-title {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #8B1538 0%, #B91C3C 50%, #DC2626 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(139, 21, 56, 0.3);
            position: relative;
        }
        
        .typewriter-title::after {
            content: '';
            position: absolute;
            right: -2px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: #8B1538;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1f2937;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }

        /* Ícones simples com CSS */
        .icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            vertical-align: middle;
        }
        
        .icon-plus::before { content: "➕"; }
        .icon-stats::before { content: "📊"; }
        .icon-download::before { content: "💾"; }
        .icon-trash::before { content: "🗑️"; }
        .icon-flame::before { content: "🔥"; }
        .icon-search::before { content: "🔍"; }
        .icon-filter::before { content: "⚙️"; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef, useMemo } = React;

        // Componente de ícone simples
        const Icon = ({ name, size = 20, className = "" }) => {
            const iconMap = {
                plus: "➕",
                stats: "📊", 
                download: "💾",
                trash: "🗑️",
                flame: "🔥",
                search: "🔍",
                filter: "⚙️",
                calendar: "📅",
                trophy: "🏆",
                target: "🎯",
                clock: "⏰",
                save: "💾",
                check: "✅",
                alert: "⚠️",
                x: "❌",
                edit: "✏️",
                eye: "👁️",
                refresh: "🔄",
                settings: "⚙️"
            };
            
            return (
                <span 
                    className={`inline-block ${className}`} 
                    style={{ fontSize: `${size}px`, lineHeight: 1 }}
                >
                    {iconMap[name] || "•"}
                </span>
            );
        };

        const CircularHabitCalendar = () => {
            const [currentMonth, setCurrentMonth] = useState(new Date().getMonth());
            const [currentYear, setCurrentYear] = useState(new Date().getFullYear());
            const [monthlyHabits, setMonthlyHabits] = useState({});
            const [habitData, setHabitData] = useState({});
            const [newHabit, setNewHabit] = useState('');
            const [selectedPriority, setSelectedPriority] = useState('medium');
            const [selectedDaysType, setSelectedDaysType] = useState('all');
            const [showAddForm, setShowAddForm] = useState(false);
            const [hoveredDay, setHoveredDay] = useState(null);
            const [hoveredHabit, setHoveredHabit] = useState(null);
            const [priorityFilter, setPriorityFilter] = useState('all');
            const [searchTerm, setSearchTerm] = useState('');
            const [showStats, setShowStats] = useState(false);
            const [focusedDay, setFocusedDay] = useState(null);
            const [rotationAngle, setRotationAngle] = useState(0);
            const [selectedHabitId, setSelectedHabitId] = useState(null);
            const [resetStatus, setResetStatus] = useState('');
            const [saveStatus, setSaveStatus] = useState('saved');
            const [autoSaveEnabled, setAutoSaveEnabled] = useState(true);

            const monthNames = [
                'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];

            const priorityColors = {
                high: { bg: 'bg-red-500', text: 'text-red-100', stroke: '#dc2626' },
                medium: { bg: 'bg-yellow-500', text: 'text-yellow-100', stroke: '#eab308' },
                low: { bg: 'bg-blue-500', text: 'text-blue-100', stroke: '#2563eb' }
            };

            const priorities = [
                { value: 'high', label: 'Alta', flag: '🔥' },
                { value: 'medium', label: 'Média', flag: '⚡' },
                { value: 'low', label: 'Baixa', flag: '💧' }
            ];

            const daysTypes = [
                { value: 'all', label: 'Todos os dias' },
                { value: 'weekdays', label: 'Dias úteis' },
                { value: 'weekends', label: 'Fins de semana' }
            ];

            // Storage functions
            function saveToLocalStorage(key, data) {
                try {
                    if (typeof(Storage) !== "undefined") {
                        localStorage.setItem(key, JSON.stringify(data));
                        return true;
                    }
                    return false;
                } catch (error) {
                    console.error('Erro ao salvar:', error);
                    return false;
                }
            }

            function loadFromLocalStorage(key) {
                try {
                    if (typeof(Storage) !== "undefined") {
                        const item = localStorage.getItem(key);
                        return item ? JSON.parse(item) : null;
                    }
                    return null;
                } catch (error) {
                    console.error('Erro ao carregar:', error);
                    return null;
                }
            }

            // Auto-save
            const autoSave = useCallback(() => {
                if (!autoSaveEnabled) return;

                try {
                    saveToLocalStorage('habitTracker_monthlyHabits', monthlyHabits);
                    saveToLocalStorage('habitTracker_habitData', habitData);
                    setSaveStatus('saved');
                } catch (error) {
                    setSaveStatus('error');
                }
            }, [monthlyHabits, habitData, autoSaveEnabled]);

            // Load data on startup
            useEffect(() => {
                const loadedHabits = loadFromLocalStorage('habitTracker_monthlyHabits');
                const loadedData = loadFromLocalStorage('habitTracker_habitData');

                if (loadedHabits) setMonthlyHabits(loadedHabits);
                if (loadedData) setHabitData(loadedData);
            }, []);

            // Auto-save on data changes
            useEffect(() => {
                const timer = setTimeout(autoSave, 1000);
                return () => clearTimeout(timer);
            }, [autoSave]);

            const getDaysInMonth = (month, year) => new Date(year, month + 1, 0).getDate();
            const getMonthKey = () => `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}`;

            const addHabit = () => {
                if (newHabit.trim() === '') return;

                const monthKey = getMonthKey();
                const habitId = Date.now().toString();

                const newHabitData = {
                    id: habitId,
                    name: newHabit,
                    priority: selectedPriority,
                    daysType: selectedDaysType,
                    createdAt: new Date().toISOString()
                };

                setHabitData(prev => ({
                    ...prev,
                    [habitId]: newHabitData
                }));

                setMonthlyHabits(prev => ({
                    ...prev,
                    [monthKey]: {
                        ...prev[monthKey],
                        [habitId]: {}
                    }
                }));

                setNewHabit('');
                setShowAddForm(false);
            };

            const deleteHabit = (habitId) => {
                const monthKey = getMonthKey();

                setHabitData(prev => {
                    const newData = { ...prev };
                    delete newData[habitId];
                    return newData;
                });

                setMonthlyHabits(prev => ({
                    ...prev,
                    [monthKey]: Object.fromEntries(
                        Object.entries(prev[monthKey] || {}).filter(([id]) => id !== habitId)
                    )
                }));

                if (selectedHabitId === habitId) {
                    setSelectedHabitId(null);
                }
            };

            const toggleHabitDay = (habitId, day) => {
                const monthKey = getMonthKey();

                setMonthlyHabits(prev => {
                    const currentValue = prev[monthKey]?.[habitId]?.[day] || false;
                    return {
                        ...prev,
                        [monthKey]: {
                            ...prev[monthKey],
                            [habitId]: {
                                ...prev[monthKey]?.[habitId],
                                [day]: !currentValue
                            }
                        }
                    };
                });
            };

            const getCompletionRate = (habitId) => {
                const monthKey = getMonthKey();
                const habitDays = monthlyHabits[monthKey]?.[habitId] || {};
                const daysInMonth = getDaysInMonth(currentMonth, currentYear);
                const today = new Date().getDate();
                const currentDay = (currentYear === new Date().getFullYear() && currentMonth === new Date().getMonth()) ? today : daysInMonth;

                const completedDays = Object.entries(habitDays)
                    .filter(([day, completed]) => completed && parseInt(day) <= currentDay)
                    .length;

                return Math.round((completedDays / currentDay) * 100);
            };

            const getCurrentStreak = (habitId) => {
                const monthKey = getMonthKey();
                const habitDays = monthlyHabits[monthKey]?.[habitId] || {};
                const today = new Date().getDate();

                let streak = 0;
                for (let day = today; day >= 1; day--) {
                    if (habitDays[day]) {
                        streak++;
                    } else {
                        break;
                    }
                }
                return streak;
            };

            const filteredHabits = useMemo(() => {
                const habits = Object.values(habitData).filter(habit => {
                    if (priorityFilter !== 'all' && habit.priority !== priorityFilter) return false;
                    if (searchTerm && !habit.name.toLowerCase().includes(searchTerm.toLowerCase())) return false;
                    return true;
                });

                return habits.sort((a, b) => {
                    const priorityOrder = { high: 3, medium: 2, low: 1 };
                    return priorityOrder[b.priority] - priorityOrder[a.priority];
                });
            }, [habitData, priorityFilter, searchTerm]);

            const generateCircularCalendar = () => {
                const daysInMonth = getDaysInMonth(currentMonth, currentYear);
                const radius = 180;
                const centerX = 250;
                const centerY = 250;

                const fixedElements = [];
                const rotatingElements = [];

                // Central circle
                fixedElements.push(
                    <circle key="center-bg" cx={centerX} cy={centerY} r="60" fill="#1f2937" stroke="#374151" strokeWidth="2" />,
                    <text key="month-text" x={centerX} y={centerY - 5} textAnchor="middle" className="fill-white text-sm font-semibold">
                        {monthNames[currentMonth]}
                    </text>,
                    <text key="year-text" x={centerX} y={centerY + 15} textAnchor="middle" className="fill-gray-300 text-xs">
                        {currentYear}
                    </text>
                );

                // Day numbers
                for (let day = 1; day <= daysInMonth; day++) {
                    const angle = ((day - 1) / daysInMonth) * 2 * Math.PI - Math.PI / 2;
                    const x = centerX + Math.cos(angle) * (radius - 30);
                    const y = centerY + Math.sin(angle) * (radius - 30);

                    fixedElements.push(
                        <text
                            key={`day-${day}`}
                            x={x}
                            y={y + 4}
                            textAnchor="middle"
                            className={`text-xs font-medium ${
                                day === new Date().getDate() && 
                                currentMonth === new Date().getMonth() && 
                                currentYear === new Date().getFullYear()
                                    ? 'fill-red-400'
                                    : 'fill-gray-300'
                            }`}
                        >
                            {day}
                        </text>
                    );
                }

                // Habits
                filteredHabits.forEach((habit, habitIndex) => {
                    const monthKey = getMonthKey();
                    const habitDays = monthlyHabits[monthKey]?.[habit.id] || {};
                    const isSelected = selectedHabitId === habit.id;
                    const colors = priorityColors[habit.priority];

                    for (let day = 1; day <= daysInMonth; day++) {
                        const angle = ((day - 1) / daysInMonth) * 2 * Math.PI - Math.PI / 2 + (rotationAngle * Math.PI / 180);
                        const radiusOffset = 15 + habitIndex * 25;
                        const x = centerX + Math.cos(angle) * (radius - radiusOffset);
                        const y = centerY + Math.sin(angle) * (radius - radiusOffset);

                        const isCompleted = habitDays[day] || false;
                        const isToday = day === new Date().getDate() && 
                                       currentMonth === new Date().getMonth() && 
                                       currentYear === new Date().getFullYear();
                        const isHovered = hoveredDay === day && hoveredHabit === habit.id;

                        // Create diamond
                        const size = isSelected ? 8 : (isHovered ? 7 : 6);
                        const pathData = `M ${x} ${y - size} L ${x + size} ${y} L ${x} ${y + size} L ${x - size} ${y} Z`;

                        const baseFill = isCompleted ? colors.stroke : 'transparent';
                        const strokeWidth = isToday ? 3 : (isHovered || isSelected ? 2 : 1);
                        const finalStroke = isToday ? '#ef4444' : colors.stroke;

                        rotatingElements.push(
                            <path
                                key={`${habit.id}-${day}`}
                                d={pathData}
                                fill={baseFill}
                                stroke={finalStroke}
                                strokeWidth={strokeWidth}
                                className="cursor-pointer"
                                style={{
                                    opacity: isCompleted ? 1 : 0.7,
                                    transition: 'opacity 0.2s ease'
                                }}
                                onClick={(e) => {
                                    e.stopPropagation();
                                    toggleHabitDay(habit.id, day);
                                }}
                                onMouseEnter={() => {
                                    setHoveredDay(day);
                                    setHoveredHabit(habit.id);
                                }}
                                onMouseLeave={() => {
                                    setHoveredDay(null);
                                    setHoveredHabit(null);
                                }}
                            />
                        );
                    }
                });

                return { fixedElements, rotatingElements };
            };

            const getMonthlyStats = () => {
                const monthKey = getMonthKey();
                const habits = filteredHabits;
                const daysInMonth = getDaysInMonth(currentMonth, currentYear);

                let totalDays = 0;
                let completedDays = 0;

                habits.forEach(habit => {
                    const habitDays = monthlyHabits[monthKey]?.[habit.id] || {};
                    totalDays += daysInMonth;
                    completedDays += Object.values(habitDays).filter(Boolean).length;
                });

                const overallRate = totalDays > 0 ? Math.round((completedDays / totalDays) * 100) : 0;

                return {
                    totalHabits: habits.length,
                    overallRate,
                    totalCompleted: completedDays,
                    totalPossible: totalDays
                };
            };

            const createBackup = () => {
                try {
                    const backupData = {
                        version: '2.7',
                        timestamp: new Date().toISOString(),
                        monthlyHabits,
                        habitData
                    };

                    const backupString = JSON.stringify(backupData, null, 2);
                    const blob = new Blob([backupString], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);

                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `habit-tracker-backup-${new Date().toISOString().split('T')[0]}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);

                    setSaveStatus('backup-created');
                    setTimeout(() => setSaveStatus('saved'), 3000);
                } catch (error) {
                    setSaveStatus('error');
                }
            };

            const clearAllData = () => {
                if (confirm('Tem certeza que deseja limpar todos os dados?')) {
                    localStorage.removeItem('habitTracker_monthlyHabits');
                    localStorage.removeItem('habitTracker_habitData');
                    setHabitData({});
                    setMonthlyHabits({});
                    setResetStatus('✅ Dados limpos!');
                    setTimeout(() => setResetStatus(''), 3000);
                }
            };

            const stats = getMonthlyStats();
            const { fixedElements, rotatingElements } = generateCircularCalendar();

            return (
                <div className="min-h-screen bg-gray-900 p-4">
                    <div className="max-w-7xl mx-auto">
                        {/* Header */}
                        <div className="text-center mb-8">
                            <h1 className="text-4xl md:text-6xl font-black mb-6 typewriter-title">
                                RASTREADOR DE HÁBITOS
                            </h1>

                            {/* Save status */}
                            {saveStatus !== 'saved' && (
                                <div className="mb-4">
                                    <span className={`px-3 py-1 rounded-full text-sm ${
                                        saveStatus === 'saving' ? 'bg-yellow-900/20 text-yellow-400' :
                                        saveStatus === 'backup-created' ? 'bg-green-900/20 text-green-400' :
                                        'bg-red-900/20 text-red-400'
                                    }`}>
                                        {saveStatus === 'saving' && '💾 Salvando...'}
                                        {saveStatus === 'backup-created' && '📥 Backup criado!'}
                                        {saveStatus === 'error' && '❌ Erro ao salvar'}
                                    </span>
                                </div>
                            )}

                            {/* Month navigation */}
                            <div className="flex items-center justify-center gap-6 mb-6">
                                <button
                                    onClick={() => {
                                        let [newMonth, newYear] = [currentMonth - 1, currentYear];
                                        if (newMonth < 0) { newMonth = 11; newYear--; }
                                        setCurrentMonth(newMonth);
                                        setCurrentYear(newYear);
                                        setRotationAngle(0);
                                    }}
                                    className="bg-gray-800 hover:bg-gray-700 text-white p-3 rounded-full transition-colors"
                                >
                                    ←
                                </button>

                                <span className="text-2xl font-bold text-white min-w-[200px]">
                                    {monthNames[currentMonth]} {currentYear}
                                </span>

                                <button
                                    onClick={() => {
                                        let [newMonth, newYear] = [currentMonth + 1, currentYear];
                                        if (newMonth > 11) { newMonth = 0; newYear++; }
                                        setCurrentMonth(newMonth);
                                        setCurrentYear(newYear);
                                        setRotationAngle(0);
                                    }}
                                    className="bg-gray-800 hover:bg-gray-700 text-white p-3 rounded-full transition-colors"
                                >
                                    →
                                </button>
                            </div>
                        </div>

                        {/* Controls */}
                        <div className="flex flex-wrap gap-4 mb-6 justify-center">
                            <button
                                onClick={() => setShowAddForm(!showAddForm)}
                                className="bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-lg flex items-center gap-2"
                            >
                                <Icon name="plus" />
                                Adicionar Hábito
                            </button>

                            <button
                                onClick={() => setShowStats(!showStats)}
                                className="bg-purple-600 hover:bg-purple-500 text-white px-6 py-3 rounded-lg flex items-center gap-2"
                            >
                                <Icon name="stats" />
                                Estatísticas
                            </button>

                            <button
                                onClick={createBackup}
                                className="bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-lg flex items-center gap-2"
                            >
                                <Icon name="download" />
                                Backup
                            </button>

                            <button
                                onClick={clearAllData}
                                className="bg-red-600 hover:bg-red-500 text-white px-6 py-3 rounded-lg flex items-center gap-2"
                            >
                                <Icon name="trash" />
                                Limpar
                            </button>
                        </div>

                        {/* Filters */}
                        <div className="flex flex-wrap gap-4 mb-6 justify-center">
                            <div className="flex items-center gap-2">
                                <Icon name="filter" size={16} className="text-gray-400" />
                                <select
                                    value={priorityFilter}
                                    onChange={(e) => setPriorityFilter(e.target.value)}
                                    className="bg-gray-800 text-white px-3 py-2 rounded-lg border border-gray-600"
                                >
                                    <option value="all">Todas as prioridades</option>
                                    <option value="high">🔥 Alta</option>
                                    <option value="medium">⚡ Média</option>
                                    <option value="low">💧 Baixa</option>
                                </select>
                            </div>

                            <div className="flex items-center gap-2">
                                <Icon name="search" size={16} className="text-gray-400" />
                                <input
                                    type="text"
                                    placeholder="Buscar hábitos..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                    className="bg-gray-800 text-white px-3 py-2 rounded-lg border border-gray-600"
                                />
                            </div>
                        </div>

                        {/* Add Form */}
                        {showAddForm && (
                            <div className="mb-8 p-6 bg-gray-800 rounded-xl border border-gray-700">
                                <h3 className="text-xl font-bold text-white mb-4">Adicionar Novo Hábito</h3>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <input
                                        type="text"
                                        placeholder="Nome do hábito"
                                        value={newHabit}
                                        onChange={(e) => setNewHabit(e.target.value)}
                                        className="bg-gray-700 text-white px-4 py-2 rounded-lg"
                                        onKeyPress={(e) => e.key === 'Enter' && addHabit()}
                                    />
                                    <select
                                        value={selectedPriority}
                                        onChange={(e) => setSelectedPriority(e.target.value)}
                                        className="bg-gray-700 text-white px-4 py-2 rounded-lg"
                                    >
                                        {priorities.map(priority => (
                                            <option key={priority.value} value={priority.value}>
                                                {priority.flag} {priority.label}
                                            </option>
                                        ))}
                                    </select>
                                    <select
                                        value={selectedDaysType}
                                        onChange={(e) => setSelectedDaysType(e.target.value)}
                                        className="bg-gray-700 text-white px-4 py-2 rounded-lg"
                                    >
                                        {daysTypes.map(type => (
                                            <option key={type.value} value={type.value}>
                                                {type.label}
                                            </option>
                                        ))}
                                    </select>
                                </div>
                                <div className="flex gap-4 mt-4">
                                    <button
                                        onClick={addHabit}
                                        className="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg"
                                    >
                                        Adicionar
                                    </button>
                                    <button
                                        onClick={() => setShowAddForm(false)}
                                        className="bg-gray-600 hover:bg-gray-500 text-white px-6 py-2 rounded-lg"
                                    >
                                        Cancelar
                                    </button>
                                </div>
                            </div>
                        )}

                        {/* Stats */}
                        {showStats && (
                            <div className="mb-8 p-6 bg-gray-800 rounded-xl border border-gray-700">
                                <h3 className="text-xl font-bold text-white mb-4">Estatísticas do Mês</h3>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    <div className="text-center">
                                        <div className="text-3xl font-bold text-blue-400">{stats.totalHabits}</div>
                                        <div className="text-gray-400">Hábitos</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-3xl font-bold text-green-400">{stats.overallRate}%</div>
                                        <div className="text-gray-400">Taxa Geral</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-3xl font-bold text-yellow-400">{stats.totalCompleted}</div>
                                        <div className="text-gray-400">Completados</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-3xl font-bold text-purple-400">{stats.totalPossible}</div>
                                        <div className="text-gray-400">Total Possível</div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Reset Status */}
                        {resetStatus && (
                            <div className="mb-4 text-center">
                                <span className="bg-blue-900/20 text-blue-400 px-4 py-2 rounded-full text-sm">
                                    {resetStatus}
                                </span>
                            </div>
                        )}

                        {/* Main Content */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            {/* Circular Calendar */}
                            <div className="lg:col-span-2">
                                <div className="relative flex justify-center items-center">
                                    <svg width="500" height="500" viewBox="0 0 500 500" className="max-w-full h-auto">
                                        {fixedElements}
                                        <g style={{ transform: `rotate(${rotationAngle}deg)`, transformOrigin: '250px 250px' }}>
                                            {rotatingElements}
                                        </g>
                                    </svg>
                                </div>

                                {/* Rotation Control */}
                                <div className="mt-4 text-center">
                                    <input
                                        type="range"
                                        min="-180"
                                        max="180"
                                        value={rotationAngle}
                                        onChange={(e) => setRotationAngle(parseInt(e.target.value))}
                                        className="w-full max-w-md"
                                    />
                                    <div className="text-sm text-gray-400 mt-2">
                                        Rotação: {rotationAngle}°
                                    </div>
                                </div>
                            </div>

                            {/* Habit List */}
                            <div className="space-y-4">
                                <h3 className="text-xl font-bold text-white">Hábitos ({filteredHabits.length})</h3>
                                
                                {filteredHabits.length === 0 ? (
                                    <div className="text-center py-8">
                                        <div className="text-4xl mb-4">📅</div>
                                        <p className="text-gray-300 mb-4">Nenhum hábito encontrado</p>
                                        <p className="text-gray-400 text-sm">Clique em "Adicionar Hábito" para começar!</p>
                                    </div>
                                ) : (
                                    <div className="space-y-3">
                                        {filteredHabits.map((habit, index) => {
                                            const percentage = getCompletionRate(habit.id);
                                            const streak = getCurrentStreak(habit.id);
                                            const colors = priorityColors[habit.priority];
                                            
                                            return (
                                                <div
                                                    key={habit.id}
                                                    className={`p-4 rounded-xl border transition-all cursor-pointer ${
                                                        selectedHabitId === habit.id 
                                                            ? 'bg-gray-700/70 border-blue-500' 
                                                            : 'bg-gray-700/50 border-gray-600 hover:bg-gray-700/70'
                                                    }`}
                                                    onClick={() => setSelectedHabitId(selectedHabitId === habit.id ? null : habit.id)}
                                                >
                                                    <div className="flex items-center justify-between">
                                                        <div className="flex items-center gap-3 flex-1">
                                                            <div className={`w-4 h-4 rounded-full ${colors.bg}`}></div>
                                                            <div className="flex-1">
                                                                <div className="text-white font-medium">{habit.name}</div>
                                                                <div className="text-xs text-gray-400">
                                                                    Anel {index + 1} • {priorities.find(p => p.value === habit.priority)?.flag} {priorities.find(p => p.value === habit.priority)?.label}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div className="flex items-center gap-3">
                                                            {streak > 0 && (
                                                                <div className="flex items-center gap-1 bg-orange-500/20 px-2 py-1 rounded-full">
                                                                    <Icon name="flame" size={12} className="text-orange-400" />
                                                                    <span className="text-xs text-orange-400 font-bold">{streak}</span>
                                                                </div>
                                                            )}
                                                            <span className="text-sm font-bold text-white">{percentage}%</span>
                                                            <button
                                                                onClick={(e) => {
                                                                    e.stopPropagation();
                                                                    deleteHabit(habit.id);
                                                                }}
                                                                className="text-red-400 hover:text-red-300"
                                                            >
                                                                <Icon name="trash" size={16} />
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Footer */}
                        <div className="mt-12 text-center text-gray-500 text-sm">
                            <p>Rastreador de Hábitos Circular v2.7 • Auto-save: {autoSaveEnabled ? 'Ativo' : 'Inativo'}</p>
                            <p className="mt-2">🎯 Clique nos losangos do calendário para marcar hábitos completados!</p>
                        </div>
                    </div>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<CircularHabitCalendar />, document.getElementById('root'));
    </script>
</body>
</html>
